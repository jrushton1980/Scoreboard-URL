<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scoreboard Overlay</title>
<style>
body {
  margin:0;
  padding:0;
  font-family: Arial, sans-serif;
  background: transparent;
  display:flex;
  flex-direction: column;
  align-items:center;
}

.scoreboard-wrapper {
  position: relative;
  display:flex;
  justify-content:center;
  align-items:center;
  margin-top:40px;
}

/* Team cards */
.team-card {
  display:flex;
  align-items:center;
  justify-content:space-between;
  width:260px;
  height:55px;
  background: rgba(0,0,0,0.7);
  border-radius:15px;
  padding:10px 15px;
  z-index:1;
}

.team-info {
  display:flex;
  flex-direction:column;
  justify-content:center;
  flex-grow:1;
  margin-left:10px;
}

.team-logo {
  width:60px;
  height:60px;
  border-radius:50%;
  object-fit:cover;
  border:2px solid #fff;
}

.team-name, .shots {
  color:#fff;
}

.team-name {
  font-size:20px;
  font-weight:bold;
}

.shots {
  font-size:16px;
}

/* Central score */
.central-score {
  position:absolute;
  font-weight:bold;
  font-size:40px;
  background:rgba(0,0,0,0.7);
  padding:15px 15px;
  border-radius:20px;
  box-shadow:0 0 20px rgba(0,0,0,0.5);
  z-index:2;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}

.score-row {
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
}

.vs {
  font-size:32px;
  margin:0 10px;
  color:#fff;
}

.period-clock {
  font-size:18px;
  font-weight:normal;
  margin-top:5px;
  color:#fff;
}

/* Margins for team cards */
#teamAcard { margin-right:70px; }
#teamBcard { margin-left:70px; }

</style>
</head>
<body>

<div class="scoreboard-wrapper">
  <!-- Team A -->
  <div class="team-card" id="teamAcard">
    <img class="team-logo" id="teamALogo">
    <div class="team-info">
      <div class="team-name" id="teamAName"></div>
      <div class="shots" id="teamAShots"></div>
    </div>
  </div>

  <!-- Central Score -->
  <div class="central-score">
    <div class="score-row">
      <span id="scoreA">0</span>
      <span class="vs">-</span>
      <span id="scoreB">0</span>
    </div>
    <div class="period-clock" id="periodClock">20:00 | Per 1</div>
  </div>

  <!-- Team B -->
  <div class="team-card" id="teamBcard">
    <img class="team-logo" id="teamBLogo">
    <div class="team-info">
      <div class="team-name" id="teamBName"></div>
      <div class="shots" id="teamBShots"></div>
    </div>
  </div>
</div>

<script>
const DATA_URL = "https://script.google.com/macros/s/AKfycbwpoQ1EAx7aNd2fmMqr_HcP-WNETMaGu8Fhz78RO9_MwR1BeXjPdfPmCzKQsm24_v5j/exec"; // replace with your Google Apps Script /exec URL

let timerSeconds = 20*60;
let period = 1;
let running = false;

// Format seconds as MM:SS
function formatTime(sec){
  const m = Math.floor(sec/60);
  const s = sec%60;
  return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}

// Update the clock display
function updateClockDisplay(){
  document.getElementById("periodClock").innerText = `${formatTime(timerSeconds)} | Per ${period}`;
}

// Fetch team & score data from Google Sheets
async function refresh(){
  try{
    const res = await fetch(DATA_URL);
    const data = await res.json();

    document.getElementById("teamALogo").src = data.teamALogo;
    document.getElementById("teamAName").innerText = data.teamAName;
    document.getElementById("teamAShots").innerText = `Shots: ${data.teamAShots}`;
    document.getElementById("teamAcard").style.backgroundColor = data.teamAColor + "33";

    document.getElementById("teamBLogo").src = data.teamBLogo;
    document.getElementById("teamBName").innerText = data.teamBName;
    document.getElementById("teamBShots").innerText = `Shots: ${data.teamBShots}`;
    document.getElementById("teamBcard").style.backgroundColor = data.teamBColor + "33";

    document.getElementById("scoreA").innerText = data.teamAScore;
    document.getElementById("scoreB").innerText = data.teamBScore;

    period = data.Period;
    const [m,s] = (data.DefaultPeriodLength || "20:00").split(":").map(Number);
    if(!running) timerSeconds = m*60 + (s||0);

    updateClockDisplay();
  }catch(err){
    console.error("Failed to fetch scoreboard data:", err);
  }
}

// Run clock locally for smooth display
setInterval(()=>{
  if(running && timerSeconds>0) timerSeconds--;
  updateClockDisplay();
},1000);

// Refresh data every 2s
setInterval(refresh,2000);
refresh();

// Click anywhere to toggle running (temporary test)
document.body.addEventListener("click",()=>running=!running);
</script>
</body>
</html>
